<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Command Prompt</title>
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      background: #000; color: #fff;
      overflow: hidden;
      background-size: 100% 100%;
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;
      font-family: 'VGA', monospace;
    }
    #indicator {
      background: #222; color: #0f0; padding: 5px 10px; font-size: 12px;
    }
    #terminal {
      height: 100vh;
      padding: 10px 10px 60px;
      box-sizing: border-box;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    #input-container {
      position: fixed; bottom: 0; left: 0; right: 0;
      background: #111; padding: 10px; display: flex;
      box-sizing: border-box;
      z-index: 1000;
    }
    #input-prompt { margin-right: 5px; }
    #input {
      flex: 1; background: transparent; border: none; outline: none;
      color: white; font-family: 'VGA', monospace; font-size: 16px;
    }
    #username-viewer {
      position: fixed; bottom: 10px; right: 10px;
      color: #0f0; background: #222; padding: 5px 10px;
      font-family: 'VGA', monospace; font-size: 14px;
      border-radius: 4px; user-select: none; z-index: 1100;
    }
    @font-face {
      font-family: 'VGA';
      src: url('https://slimetube.github.io/vga.ttf');
    }
    noscript {
      color: red;
      background: black;
      display: block;
      padding: 20px;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <noscript>âš  JavaScript is required to use this terminal.</noscript>
  <div id="indicator"></div>
  <div id="terminal"></div>
  <div id="input-container">
    <span id="input-prompt">&gt;</span>
    <input id="input" autofocus spellcheck="false" />
  </div>
  <div id="username-viewer"></div>
<script>
const terminal = document.getElementById('terminal');
const input = document.getElementById('input');
const indicator = document.getElementById('indicator');
const usernameViewer = document.getElementById('username-viewer');

const blockedWords = ['nigger','nigga','faggot','retard','asshole','fuck','shit','bitch','slut','cunt','porn','sex'];
const blockedDomains = ['cdn.discordapp.com','rule34','porn','hentai','xxx','adult'];
const rainbowColors = ['red','orange','yellow','green','blue','indigo','violet'];

const defaultPfps = [
  'https://i.imgur.com/D299rno.gif',
  'https://slimetube.github.io/src/carly.webp',
  'https://slimetube.github.io/src/sam.webp',
  'https://slimetube.github.io/src/fred.webp',
  'https://slimetube.github.io/src/spen.webp',
  'https://slimetube.github.io/src/vee.webp'
];

let username = localStorage.getItem('cmd_username') || "bubble app";
let pfp = localStorage.getItem('cmd_pfp') || defaultPfps[Math.floor(Math.random() * defaultPfps.length)];

const history = JSON.parse(localStorage.getItem('cmd_history') || '[]');
let historyIndex = history.length;

indicator.textContent = `Platform: ${navigator.platform} | UA: ${navigator.userAgent}`;

function escapeHtml(text) {
  return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
}

function write(text, color) {
  const div = document.createElement('div');
  div.innerHTML = text;
  if (color) div.style.color = color;
  terminal.appendChild(div);
  terminal.scrollTop = terminal.scrollHeight;
}

function updateUsernameViewer() {
  usernameViewer.textContent = `User: ${username}`;
}

async function safeFetch(url) {
  for (let domain of blockedDomains) {
    if (url.includes(domain)) {
      write(`Blocked domain: ${domain}`, 'red');
      throw '';
    }
  }
  try {
    const r = await fetch(url);
    if (!r.ok) throw 'Failed';
    return r;
  } catch {
    write(`${url} failed due to CORS.`, 'red');
    throw '';
  }
}

async function runCommand(cmd, piped = '') {
  const parts = cmd.trim().split(' ');
  const base = parts[0].toLowerCase();
  let out = '';

  if (base === 'clear') {
    terminal.innerHTML = '';
  } else if (base === 'help') {
    write(`Commands:
clear, help, echo, curl, swapbg, fontswap, theme, speak, 
platform, useragent, date, username, webhookpfp, dump, bart, 
ai, open, littlecaesars, pizz-zza, dscrd, pfp, unixtime`);
  } else if (base === 'echo') {
    out = escapeHtml(parts.slice(1).join(' ') || piped);
    write(out);
  } else if (base === 'curl') {
    const url = parts[1];
    if (!url) return write('Usage: curl <url>');
    const r = await safeFetch(url);
    out = escapeHtml(await r.text());
    write(out);
  } else if (base === 'dscrd') {
    const msg = parts.slice(1).join(' ') || piped;
    if (blockedWords.some(w => msg.toLowerCase().includes(w))) return write('Blocked!');
    await fetch('https://discord.com/api/webhooks/1393396765012660224/weXmVY6hr6lu25FmDQnmmLSvjEcqnWH6LKGzku-aBI32C3uflaH7eu4sbICNv78HCVN-', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ content: msg, username: username, avatar_url: pfp })
    });
    write('Sent!');
  } else if (base === 'littlecaesars' || base === 'pizz-zza') {
    write('Pizza Pizza!');
    await fetch('https://discord.com/api/webhooks/1393389311940100096/HZ2UJdrhl42KH36zt-w3HUF6jUPlSASDZBtxcpmiCVhhu6Mjy3yloWLG-9E4Aag78bCn', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({
        content: `Pizza Pizza! ${username} activated Little Caesars!`,
        username: username,
        avatar_url: pfp
      })
    });
  } else if (base === 'unixtime') {
    const num = Number(parts[1]);
    if (isNaN(num)) {
      write('Usage: unixtime <number>');
    } else {
      const d = new Date(num * 1000);
      write(`${num} => ${d.toUTCString()} | ${d.toString()}`);
    }
  } else {
    write('Unknown command');
  }
  return out;
}

async function handle(cmd) {
  write(`> ${escapeHtml(cmd)}`);
  await runCommand(cmd);
}

input.addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    const cmd = input.value.trim();
    history.push(cmd);
    localStorage.setItem('cmd_history', JSON.stringify(history));
    handle(cmd);
    input.value = '';
    historyIndex = history.length;
  }
});
updateUsernameViewer();
write(`Welcome ${username}! Type "help" to see commands.`);
</script>
</body>
</html>
